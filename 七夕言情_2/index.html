<!DOCTYPE html>
<html>

	<head>
		<meta charset="utf-8" />
		<title>慕课七夕主题</title>
		<link rel='stylesheet' href='css/style.css'>
		<link rel='stylesheet' href='css/pageA.css'>
		<link rel='stylesheet' href='css/pageB.css'>
		<link rel='stylesheet' href='css/pageC.css'>
		<script src="js/jQueryJavaScriptLibrary v2.1.4.js"></script>
		<script src="js/jquery.transit.js"></script>

	</head>
	<style type="text/css">

	</style>

	<body>
		<div id="content">
			<ul class='content-wrap'>
				<li>
					<div class="a_background">
						<div class="a_background_top"></div>
						<div class="a_background_middle"></div>
						<div class="a_background_bottom"></div>
					</div>
					<div class="cloudArea">
						<div class="cloud cloud1"></div>
						<div class="cloud cloud2"></div>
					</div>
					<div id="sun"></div>
				</li>
				<li>
					<div class="b_background"></div>
					<div class="b_background_preload"></div>
					<div class="shop">
						<div class="door">
							<div class="door-left"></div>
							<div class="door-right"></div>
						</div>
						<div class="lamp"></div>
					</div>
					<div class="bird"></div>
				</li>
				<li>
					<div class="c_background">
						<div class="c_background_top"></div>
						<div class="c_background_middle"></div>
						<div class="c_background_bottom"></div>
					</div>
					<div class="girl"></div>
					<div class="bridge-bottom">
						<div class="water">
							<div id="water1" class="water_1"></div>
							<div id="water2" class="water_2"></div>
							<div id="water3" class="water_3"></div>
							<div id="water4" class="water_4"></div>
						</div>
					</div>
					<ul class="stars">
						<li class="stars1"></li>
						<li class="stars2"></li>
						<li class="stars3"></li>
						<li class="stars4"></li>
						<li class="stars5"></li>
						<li class="stars6"></li>
					</ul>
					<div class="logo"></div>
				</li>
			</ul>
			<div id='boy' class="charector"></div>
			<div class="button">
				<button>开始</button>
				<!--<button>关门灭灯</button>-->
			</div>
		</div>
		<script type="text/javascript">
			$(function() {
				var boy = BoyWalk();
				boy.talkFlower();

				var girl = {
					elem: $('.girl'),
					getHeight: function() {
						return this.elem.height();
					},
					rotate: function() {
						this.elem.addClass('girl-rotate');
					},
					setPosition: function() {
						this.elem.css({
							left: $('#content').width() / 2,
							top: bridgeY - this.getHeight()
						});
					},
					getPosition: function() {
						return this.elem.position();
					},
					getWidth: function() {
						return this.elem.width();
					}
				}
				
				girl.setPosition();

				var logo = {
					elem: $('.logo'),
					run: function() {
						this.elem.addClass('logolightSpeedIn').on(animationEnd, function() {
							$(this).addClass('logoshake').off();
						});
					}
				}

				var bird = {
					elem: $('.bird'),
					fly: function() {
						this.elem.addClass('birdFly')
						this.elem.transition({
							right: container.width()
						}, 15000, 'linear');
					}
				}

//				function startRun() {
//					boy.walkTo(2000, 0.5).then(function() {
//						boy.stopWalk();
//					}).then(function() {
//						return openDoor();
//					}).then(function() {
//						lamp.bright();
//					}).then(function() {
//						return boy.toShop(2000);
//					}).then(function() {
//						return boy.talkFlower();
//					}).then(function() {
//						bird.fly();
//					}).then(function() {
//						return boy.outShop(2000);
//					}).then(function() {
//						return shutDoor();
//					}).then(function() {
//						lamp.dark();
//					});
//				}
//
//				$('button:first').click(startRun);

				$("button:first").click(function() {
					boy.walkTo(2000, 0.15).then(function() {
						return boy.walkTo(1500, 0.25, girl.getPosition().top / $('#content').height())
					}).then(function() {
						var proportionX = (girl.getPosition().left - boy.getWidth() + girl.getWidth() / 5) / container.width();
						return boy.walkTo(1500, proportionX);
					}).then(function() {
						boy.resetOriginal();
					}).then(function() {
						setTimeout(function() {
							girl.rotate();
							boy.rotate(function() {
								logo.run();
							})
						}, 1000);
					})
				})
			})
		</script>
		<script type="text/javascript" src="js/Swipe.js"></script>
		<script src="js/Qixi.js"></script>
		<script src="js/BoyWalk.js"></script>
		<!--脚本上下顺序也很重要-->
		<!--脚本在body和在head中this的意义不一样-->
	</body>

</html>